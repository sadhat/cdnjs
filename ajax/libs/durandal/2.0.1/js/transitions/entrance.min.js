define(["durandal/system","durandal/composition","jquery"],function(n,t,i){var r=100,u={marginRight:0,marginLeft:0,opacity:1},f={marginLeft:"",marginRight:"",opacity:"",display:""};return function(t){return n.defer(function(n){function e(){n.resolve()}function h(){t.keepScrollPosition||i(document).scrollTop(0)}if(t.child){var c=t.duration||500,o=!!t.fadeOnly;function s(){h();t.triggerAttach();var r={marginLeft:o?"0":"20px",marginRight:o?"0":"-20px",opacity:0,display:"block"},n=i(t.child);n.css(r);n.animate(u,{duration:c,easing:"swing",always:function(){n.css(f);e()}})}t.activeView?i(t.activeView).fadeOut({duration:r,always:s}):s()}else i(t.activeView).fadeOut(r,e)}).promise()}});